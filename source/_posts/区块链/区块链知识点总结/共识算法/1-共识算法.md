---
title: 1-共识算法

date: 2023-01-23	

categories: 共识算法	

tags: [区块链,区块链知识点总结,共识算法]
---	

# 共识算法

共识算法（Consensus algorithm）是指**在分布式系统中，参与者就某个共享状态达成一致的过程或协议**。**在分布式系统中，各个节点可能由于网络延迟、节点故障或恶意行为等原因导致信息不同步，因此需要通过共识算法来解决一致性问题。**

共识算法的目标是**确保分布式系统中的节点就某个共享状态达成一致，并且保证系统的安全性、可用性和正确性**。常见的应用场景包括区块链系统、分布式数据库、分布式存储系统等。

# 以太坊的POS

以太坊采用权益证明机制，在该机制下，**验证者明确地通过以太币将资本质押到以太坊上的智能合约中**。 这些质押的以太币充当抵押品，**如果验证者有失信行为或者消极怠工，那么可以销毁抵押品。** 之后，**验证者负责检查在网络上传播的新区块是否有效，并偶尔自己也创建和传播新区块。**

### 验证者

要想作为验证者参与，**用户必须向存款合约存入 32 个以太币并运行三种独立的软件：执行客户端、共识客户端和验证者**。 存入以太币时，用户会进入一个激活队列，限制新验证者加入网络的速度。 **激活后，验证者将从以太坊网络上的对等节点接收新区块**。 区块中交付的交易会被重新执行，并且对区块签名进行检查以确保区块是有效的。 然后**验证者在整个网络上发送支持该区块的投票**（称为认证）。

在工作量证明中，生成区块的时间是由挖矿难度决定的，而在权益证明中，节奏是固定的。 权益证明以太坊中的时间分为时隙（12 秒）和时段（32 个时隙）。 **在每个时隙中随机选择一位验证者作为区块提议者。 该验证者负责创建新区块并发送给网络上的其他节点。 另外在每个时隙中，都会随机选择一个验证者委员会，通过他们的投票确定所提议区块的有效性**

### 区块创建

验证者创建区块。 **每个时隙中都会随机选择一个验证者成为区块提议者。 区块提议者的共识客户端请求配对执行客户端对交易打包，**作为“执行负载”。 然后它们**将“执行负载”包装成共识数据并形成一个区块**，再把这个区块发送给以太坊网络上的其他节点。 这样的区块生产会得到以太币奖励。 **在极少数情况下，一个时隙中产生了多个可能的区块，或节点在不同时间收到区块，**分叉选择算法就**会选择使形成的链具有最大认证权重的那个区块**（**认证权重是指为该区块提供认证的验证者数量**，并根据验证者质押的以太币余额调整）。

# 总结

**没有最好的算法，只有最适合自己的算法**。共识算法的选择与应用场景高度相关，可信环境使用Paxos 或者RAFT，带许可的联盟可使用PBFT ，非许可链可以是PoW，PoS，Ripple共识等。根据根据自己的实际需求选择共识算法，才是最优解。