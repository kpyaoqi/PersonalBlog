---
title: 07-挖矿

date: 2023-06-12	

categories: 比特币	

tags: [区块链,比特币]
---	

# 全节点和轻节点

| 全节点                                                       | 轻节点                                                   |
| ------------------------------------------------------------ | -------------------------------------------------------- |
| 一直在线                                                     | 不是一直在线                                             |
| 在本地硬盘上维护完整区块链信息                               | 不保存整个区块链，只需要保存每隔区块块头                 |
| 在内存中维护UTXO集合，以便于快速检验交易合法性               | 不保存全部交易，只保存和自己有关的交易                   |
| 监听比特币网络中交易内容，验证每个交易合法性                 | 无法验证大多数交易合法性，只能检验和自己相关的交易合法性 |
| 决定哪些交易会打包到区块中                                   | 无法检测网上发布的区块正确性                             |
| 监听其他矿工挖出的区块，验证其合法性                         | 可以验证挖矿难度                                         |
| 挖矿： 1. 决定沿着哪条链挖下去。<br /> 2. 当出现等长分叉，选择哪一个分叉 | 只能检测哪个是最长链，不知道哪个是最长合法链             |

# 比特币安全性的保证？

一是密码学的保证：别人没有自己的私钥，就无法伪造其合法签名，从而无法将其账户上BTC转走。（前提：系统中大多数算力掌握在好人手中）
二是共识机制：保证了恶意交易不被系统承认。

## 挖矿设备演化

普通CPU -> GPU （主要用于并行计算）->ASIC芯片（挖矿专用矿机）

## 大型矿池

矿池的架构如下图，通常是一个全节点驱动多台矿机。矿工只需要不停计算哈希值，而全节点其他职责由矿主来承担。ASIC芯片只能计算哈希值，不能实现全节点其他功能。此外，矿池出现解决了单个矿工收益不稳定的问题。当获得收益后，所有矿工对收益进行分配，从而保证了收益的稳定性。

![image-20230101112225339](/noteimg/C:/Users/zhuba/Desktop/PersonalBlog/source/_posts/区块链/比特币/img/image-20230101112225339.png) 

> 矿池一般具有两种组织形式。1.类似大型数据中心（同一机构），集中成千上万矿机进行哈希计算。2.分布式，矿工与矿主不认识(不同机构)，矿工与矿主联系，自愿加入其矿池，矿主分配任务，矿工进行计算，获得收益后整个矿池中所有矿工进行利益分配

### 矿池利益分配方法

假设原本挖矿难度要求，计算所得126位的哈希值前70位都必须为0，现在降低要求，只需要前60位为0，这样挖矿会更容易挖到。当然，这个哈希是不会被区块链所承认的，我们将其称为一个share，或almost valid share。矿工每挖到一个share，将其提交给矿主，矿主对其进行记录，作为矿工工作量的证明。等到某个矿工真正挖到符合要求的的区块后，根据所有矿工提交的share数量进行分配。

## 51%算力矿池可以发动哪些攻击

1. 分叉攻击
   对已经经过6次确认的交易分叉，利用51%算力将交易记录回滚。

   > 矿工只能计算哈希值，并不知道区块包含哪些交易，区块链状况是什么。
   > 此外，51%攻击只是一个概率问题，并非达到51%算力就能发动攻击，不能达到就无法发动攻击。此外，矿池本身算力也是在不断变化的。

2. 封锁交易
   假如攻击者不喜欢某个账户A，不想让A的交易上区块链，在监听到有其他人将A的交易发布到区块链上时，立刻发动分叉攻击，使A所在链无法成为”最长合法链“。这样，便实现了对A账户的封锁。

3. 盗币（将他人账户BTC转走）
   这个是**不可能**的，因为其并没有他人账户私钥。如果依仗算力强，强行将没有签名的转账发布到区块链，正常节点不会认为其合法，这样，即使这条链再长，其他人也不会认为其是最长合法链。