---
title: 06-挖矿难度调整

date: 2023-06-06	

categories: 比特币	

tags: [区块链,比特币]
---	

# 为什么要调整挖矿难度？

保持区块链的出块时间在平均10min左右，如果不调整挖矿难度，系统总算力越来越强，若挖矿难度保持不变，则出块时间会越来越短。

**出块时间越来越短是好事吗？**
出块时间缩短，那么交易可以很快便被写入区块链，并且提高了系统响应时间，增加了区块链系统效率。但是，出块时间并不是越短越好。出块时间太短，也会造成一定的问题。首先，区块在网络上传播具有时延，假如出块时间为1秒，但网络传播需要10秒，则会使得系统中节点经常性处于不一致的状态，增加了系统不稳定性，且系统经常性位于分叉状态（不仅二分叉，乃至多分叉）。分叉过多，则不利于系统达成共识，且会造成算力分散，使得黑客攻击成本大大降低(不再需要整个系统51%的算力)。

# 如何调整挖矿难度？

在BTC协议中规定，每隔2016个区块需要调整一次难度，根据10min产生一个新区块可以得到，大概需要14天的时间。具体调整如下：

![image-20230101110051568](/noteimg/C:/Users/zhuba/Desktop/PersonalBlog/source/_posts/区块链/比特币/img/image-20230101110051568.png) 

如果实际时间比较长，target会比较大，相应的挖矿难度会降低；如果实际实际比较短，target会比较小，相应的挖矿难度会增大

> 上调和下调都是有4倍的限制，例如：实际最近2016个区块出块时间超过8个星期(正常2个星期)，计算也只按照8个星期计算；实际最近2016个区块出块时间小于0.5个个星期(正常2个星期)，计算也只按照0.5个星期计算.这样是为了防止网络中出现黑天鹅事件。

# 如何让所有矿工都愿意调整这个挖矿难度呢？

这一调整算法在代码中已经写入，如果有恶意节点故意不调，其所产生的区块不会被大多数诚实的节点承认。
在block header中有一个nbits的域，它是对target的编码存储（target为256位，nbits为32位，也就是说block header并未直接存储target），其他节点在进行合法性验证时候会验证nbits域是否合法，不合法则对该区块不予以承认。

![image-20230101110536938](/noteimg/C:/Users/zhuba/Desktop/PersonalBlog/source/_posts/区块链/比特币/img/image-20230101110536938.png) 
