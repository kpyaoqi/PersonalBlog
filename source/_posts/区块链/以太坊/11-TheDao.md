---
title: 11-TheDao

date: 2022-10-14	

categories: 以太坊	

tags: [区块链,以太坊]
---	

# **The DAO**

日常我们生活中无处不见中心化组织。2016年5月，出现一个致力于众筹投资的Dao——The DAO。该组织为众筹投资基金，只是其资金来源是通过区块链众筹方式得到，本质上就是一个运行在以太坊上的智能合约。

如果想要参与其众筹，可以将自己的以太币发送到该智能合约换回The DAO的代币。当需要决定投资哪一个项目时，由代币持有者进行投票表决，每位参与者投票的权重由代笔多少决定。 当投资获得收益，也根据参与者代币数进行分成。

考虑到投资者在投资过程中可能需要用钱，需要用代币换回以太币。在The DAO的设计中采用了“拆分(split DAO)”实现这一功能。其并非单纯取回收益，而是采用生成child DAO的方法。这样可以保证小部分人的意志不被大多数人所覆盖。小部分人可以通过拆分出自己的child DAO，从而从The DAO中独立出来，收回代币换回以太币转入相应子基金中，从而方便小众化人群进行期望的投资。极端方式下，child DAO中只有一个人，这个人将钱投资给自己从而取回自己的投资与收益。拆分前有7天的讨论期，大家可以讨论拆分是否好并决定是否加入拆分。拆分之后，有28天锁定期，28天后才能取出这些以太币。也正是这28天的锁定期，给了以太坊补救时间（惊变28天）。

**方案1：从发生攻击的区块前一个区块处进行分叉，使得新分支最终超越原有分支可行吗？**

<img src="/noteimg/C:/Users/zhuba/Desktop/PersonalBlog/source/_posts/区块链/以太坊/img/image-20230107130834433.png" alt="image-20230107130834433" style="zoom:67%;" /> 

如果这样做，上面那条链上黑客攻击的交易和其他合法交易都被回滚了，这就是代价，因此该方案不可行。

**方案2：锁定黑客账户，以太坊团队发布一个升级，要求凡是与The DAO基金账户相关的账户均不被允许进行任何交易。发布后，大多数矿工都升级了这一软件，接受了这一措施。**

然而升级后的软件存在一个与汽油费相关的bug：在收到一个区块发现其中包含与The DAO账户相关交易，那么还需要收取汽油费吗？直觉告诉我们似乎不应该要，以太坊社区这一升级也遵循了这一直觉，没有收取汽油费。这导致攻击者可以以极低的成本，发起大量的这类”非法交易“请求，导致矿工打包的区块频繁不被认可。

**方案3：设法从黑客账户中退回盗取的以太币**

以太坊发布了新的升级，将The DAO账户的资金强行转入到一个新的智能合约中，而该智能合约只有**退钱**这一功能。支持者与反对者进行了激烈争论。为此，开发团队开发了一个智能合约对此进行投票。最终结果是，大多数人支持进行硬分叉，大多数矿工也接受了这一升级，大家便开始等待挖出第192w个区块这一历史性时刻。

## 后幕

硬分叉之后，原有的旧链并未消亡，仍然有许多矿工留在上面继续挖矿，与之前相比唯一区别就是算力大幅下降到不足原有的1/10，而这也使得挖矿难度大大下降。

之后，一些交易所开始上市旧链上的以太币。未分叉之前以太币称为ETH，在硬分叉之后，新的链继承了”ETH“这一名称，而旧链上则称为”ETC“，即”以太坊经典“。在这条旧链上挖矿的人有因为难度下降而来的，也有因为信仰而坚持认为旧链才是根正苗红的去中心化以太坊者。以太坊上交易所后，由于以太坊开发团队支持新链，大多数人对ETC的前景并不看好——ETH还能存在多久？然而，两条链之后逐步通过chainId进行了区分，并共同存活了下去。